{% extends "base.html" %}
{% block content %}
<div class="card">
  <div class="card-body">
    <h2 class="card-title mb-4">Resultado del Prompt: <span class="text-primary">{{ prompt.title }}</span></h2>

    <div class="mb-4">
      <h5 class="text-muted">Entrada usada:</h5>
      <pre class="bg-light p-3 rounded">{{ filled_template }}</pre>
    </div>

    <div>
      <h5 class="text-muted">Respuesta generada:</h5>
      <div class="bg-white p-3 border rounded">
        {{ response }}
      </div>
    </div>

    <form method="post" action="/prompts/{{ prompt.id }}/rate" id="rating-form">
      <div class="mb-3">
        <label class="form-label">¿Qué puntuación le das a esta plantilla?</label>
        <div id="stars" class="d-flex gap-1" style="font-size: 1.5rem; cursor: pointer;">
          {% for i in range(1, 6) %}
          <span class="star" data-value="{{ i }}">☆</span>
          {% endfor %}
        </div>
        <input type="hidden" name="rating" id="rating-input">
      </div>
      <button class="btn btn-sm btn-outline-primary mt-2">Enviar puntuación</button>
    </form>

    <style>
      .star:hover {
        color: orange;
      }

      .star {
        transition: color 0.2s ease;
      }
    </style>

    <script>
      const stars = document.querySelectorAll('.star');
      const ratingInput = document.getElementById('rating-input');

      stars.forEach(star => {
        star.addEventListener('click', () => {
          const rating = star.getAttribute('data-value');
          ratingInput.value = rating;

          // Resalta las estrellas hasta la seleccionada
          stars.forEach(s => {
            s.textContent = s.getAttribute('data-value') <= rating ? '★' : '☆';
          });
        });
      });
    </script>

  </div>
</div>
{% endblock %}